#!/data/data/com.termux/files/usr/bin/bash

clear
kill_color=$'\e[0m'
command -v yt-dlp &>/dev/null || printf "\e[031m Please install yt-dlp manualy or run the the install.sh script again.\n$kill_color"

echo -e "\e[031m" "           â–„â–€â–„     â–„â–€â–„           "
echo -e "\e[031m" "          â–„â–ˆâ–‘â–‘â–€â–€â–€â–€â–€â–‘â–‘â–ˆâ–„          "
echo -e "\e[031m" "      â–„â–„  â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆ  â–„â–„      "
echo -e "\e[031m" "     â–ˆâ–„â–„â–ˆ â–ˆâ–‘â–‘â–ˆâ–‘â–‘â”¬â–‘â–‘â–ˆâ–‘â–‘â–ˆ â–ˆâ–„â–„â–ˆ     "
echo -e "\e[036m" "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo -e "\e[032m" "â•‘ Youtube-Downloader for termux â•‘"
echo -e "\e[036m" "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo -e "\e[036m" "â• â•â–¶ [ğ—¦ğ—²ğ—¹ğ—²ğ—°ğ˜ ğ—” ğ—™ğ—¼ğ—¿ğ—ºğ—®ğ˜]"
echo -e "\e[032m" "â• â•â–¶ 1. Video (Mp4)"
echo -e "\e[032m" "â• â•â–¶ 2. Audio (Mp3)"
echo -e "\e[032m" "â• â•â–¶ 3. Video"
echo -e "\e[032m" "â• â•â–¶ 4. Audio"
echo -e "\e[032m" "â• â•â–¶ 5. Video 2160p"
echo -e "\e[032m" "â• â•â–¶ 6. Video 1440p"
echo -e "\e[032m" "â• â•â–¶ 7. Video 1080p"
echo -e "\e[032m" "â• â•â–¶ 8. Video 720p"
echo -e "\e[032m" "â• â•â–¶ 9. Video 480p"
echo -e "\e[032m" "â• â•â–¶ 10.Video 360p"
echo -e "\e[032m" "â• â•â–¶ 0. Exit Termux-YTD"
echo -e "\e[032m" "â•šâ•:â¤  $kill_color"

# Always embed metadata, have only the title als filename and put the video link as composer or subtitle in the file metadata, as almost every file format has one of these
basecommand=$'--embed-metadata --parse-metadata webpage_url:(?s)(?P<meta_composer>.+) --parse-metadata webpage_url:(?s)(?P<meta_subtitle>.+) --parse-metadata description:(?P<meta_comment>.+) -o /data/data/com.termux/files/home/storage/shared/Youtube/%(title)s.%(ext)s '

read option

if [[ -z $option ]];
then
	clear
	printf "\e[031m Please choose a option!\n%0" "$kill_color"
else
case $option in #Make Case list
	1)
	yt-dlp  "$basecommand" -f "bv*[ext=mp4]+ba[ext=m4a]/ b[ext=mp4]/ bv*+ba/ b" --embed-thumbnail --embed-chapters "$1"
	;;
	2)
	yt-dlp "$basecommand" -f ba[ext=mp3]/ba -x --audio-format mp3 --embed-thumbnail --parse-metadata "%(playlist_autonumber|)s:(?P<meta_track>.+)" --parse-metadata "%(artist,creator,uploader)s:(?P<meta_album_artist>.+)" "$1"
	;;
	3)
	yt-dlp "$basecommand" "$1"
	;;
  4)
  yt-dlp "$basecommand" -f ba[ext=mp3]/ba -x --audio-format mp3 "$1"
	;;
	5)
	height='2160'
	yt-dlp "$basecommand" -f "bv*[ext=mp4][height<=$height]+ba[ext=m4a]/ b[ext=mp4][height<=$height]/ bv[height<=$height]*+ba/ b[height<=$height]" --embed-thumbnail --embed-chapters "$1"
	;;
	6)
	height='1440'
	yt-dlp "$basecommand" -f "bv*[ext=mp4][height<=$height]+ba[ext=m4a]/ b[ext=mp4][height<=$height]/ bv[height<=$height]*+ba/ b[height<=$height]" --embed-thumbnail --embed-chapters "$1"
	;;
	7)
	height='1080'
	yt-dlp "$basecommand" -f "bv*[ext=mp4][height<=$height]+ba[ext=m4a]/ b[ext=mp4][height<=$height]/ bv[height<=$height]*+ba/ b[height<=$height]" --embed-thumbnail --embed-chapters "$1"
	;;
	8)
	height='720'
	yt-dlp "$basecommand" -f "bv*[ext=mp4][height<=$height]+ba[ext=m4a]/ b[ext=mp4][height<=$height]/ bv[height<=$height]*+ba/ b[height<=$height]" --embed-thumbnail --embed-chapters "$1"
	;;
	9)
	height='480'
	yt-dlp "$basecommand" -f "bv*[ext=mp4][height<=$height]+ba[ext=m4a]/ b[ext=mp4][height<=$height]/ bv[height<=$height]*+ba/ b[height<=$height]" --embed-thumbnail --embed-chapters "$1"
	;;
  10)
	height='360'
	yt-dlp "$basecommand" -f "bv*[ext=mp4][height<=$height]+ba[ext=m4a]/ b[ext=mp4][height<=$height]/ bv[height<=$height]*+ba/ b[height<=$height]" --embed-thumbnail --embed-chapters "$1"
	;;
  0)
  ;;

esac 
fi
